---
title: "Mid-Term Course Evaluation Results"
# author: "Allan Omondi"
# date: "`r Sys.Date()`"
output:
  html_document: 
    toc: yes
    df_print: kable
    fig_width: 9
    fig_height: 9
    fig_caption: yes
    toc_depth: 4
    keep_md: yes
  html_notebook: default
  pdf_document:
    toc: yes
    number_sections: yes
    fig_width: 8
    fig_height: 8
    fig_caption: yes
    keep_tex: yes
  always_allow_html: true
  word_document:
    toc: yes
---

```{css CSS_Chunk, echo=FALSE}
table {
  border-collapse: collapse;
  table-layout: auto;
  margin: 0 auto;
}
th {
  border-bottom: 1px solid #000;
  padding: 8px;
  text-align: center;
  vertical-align: bottom;
}
td {
  border-bottom: 1px solid #000;
  padding: 8px;
  text-align: auto;
  vertical-align: middle;
}
```

+-----------------------------------------------------------------------------------------+-------------------------------------------------------------------------+
| Key                                                                                     | Value                                                                   |
+=========================================================================================+=========================================================================+
| **Course**                                                                              | Business Intelligence II                                                |
+-----------------------------------------------------------------------------------------+-------------------------------------------------------------------------+
| **Course Code**                                                                         | BBT4206                                                                 |
+-----------------------------------------------------------------------------------------+-------------------------------------------------------------------------+
| **Class**                                                                               | BBIT 4.2                                                                |
+-----------------------------------------------------------------------------------------+-------------------------------------------------------------------------+
| **Semester Duration**                                                                   | 21^st^ August 2023 to 28^th^ November 2023                              |
+-----------------------------------------------------------------------------------------+-------------------------------------------------------------------------+
| **Date of Evaluation**                                                                  | 25^th^ September 2023 to 4^th^ October 2023\                            |
|                                                                                         | Week 6 & 7 of 14                                                        |
+-----------------------------------------------------------------------------------------+-------------------------------------------------------------------------+
| **Total number of students who submitted the course evaluation**                        | 102                                                                     |
+-----------------------------------------------------------------------------------------+-------------------------------------------------------------------------+
| **Total number of students registered in the AMS at the time of the course evaluation** | 115                                                                     |
+-----------------------------------------------------------------------------------------+-------------------------------------------------------------------------+
| **Response rate**                                                                       | 88.69%                                                                  |
+-----------------------------------------------------------------------------------------+-------------------------------------------------------------------------+
| **e-Learning URL**                                                                      | <https://elearning.strathmore.edu/course/view.php?id=6599>              |
+-----------------------------------------------------------------------------------------+-------------------------------------------------------------------------+
| **Data collection tool URL for access to the raw data**                                 | <https://elearning.strathmore.edu/mod/questionnaire/view.php?id=221958> |
+-----------------------------------------------------------------------------------------+-------------------------------------------------------------------------+
| **Lecturer**                                                                            | Dr Allan Omondi\                                                        |
|                                                                                         | \<aomondi\@strathmore.edu\>                                             |
+-----------------------------------------------------------------------------------------+-------------------------------------------------------------------------+

\newpage

------------------------------------------------------------------------

```{r STEP1.InstallandLoadtheRequiredPackages, include=FALSE, warning=FALSE}
# STEP 1. Install and Load the Required Packages ----
# The following packages can be installed and loaded before proceeding to 
# the subsequent steps.

## dplyr - For data manipulation ----
if (!is.element("dplyr", installed.packages()[, 1])) {
  install.packages("dplyr", dependencies = TRUE)
}
require("dplyr")

## ggplot2 - For data visualizations using the Grammar for Graphics package ----
if (!is.element("ggplot2", installed.packages()[, 1])) {
  install.packages("ggplot2", dependencies = TRUE)
}
require("ggplot2")

## ggrepel - Additional options for the Grammar for Graphics package ----
if (!is.element("ggrepel", installed.packages()[, 1])) {
  install.packages("ggrepel", dependencies = TRUE)
}
require("ggrepel")

## ggraph - Additional options for the Grammar for Graphics package ----
if (!is.element("ggraph", installed.packages()[, 1])) {
  install.packages("ggraph", dependencies = TRUE)
}
require("ggraph")

## tidytext - For text mining ----
if (!is.element("tidytext", installed.packages()[, 1])) {
  install.packages("tidytext", dependencies = TRUE)
}
require("tidytext")

## tidyr - To tidy messy data ----
if (!is.element("tidyr", installed.packages()[, 1])) {
  install.packages("tidyr", dependencies = TRUE)
}
require("tidyr")

## widyr - To widen, process, and re-tidy a dataset ----
if (!is.element("widyr", installed.packages()[, 1])) {
  install.packages("widyr", dependencies = TRUE)
}
require("widyr")

## gridExtra - to arrange multiple grid-based plots on a page ----
if (!is.element("gridExtra", installed.packages()[, 1])) {
  install.packages("gridExtra", dependencies = TRUE)
}
require("gridExtra")

## knitr - for dynamic report generation ----
if (!is.element("knitr", installed.packages()[, 1])) {
  install.packages("knitr", dependencies = TRUE)
}
require("knitr")

## devtools ----
if (!is.element("devtools", installed.packages()[, 1])) {
  install.packages("devtools", dependencies = TRUE)
}
require("devtools")

## kableExtra - for nicely formatted output tables ----
#if (!is.element("kableExtra", installed.packages()[, 1])) {
#  install.packages("kableExtra", dependencies = TRUE)
#}
#require("kableExtra")
# The following kableExtra is used as an alternative to the one
# stored in CRAN because of the errors when rendering to PDF.
devtools::install_github("kupietz/kableExtra")
require("kableExtra")

## formattable -  To create a formattable object ----
# A formattable object is an object to which a formatting function and related
# attributes are attached.
if (!is.element("formattable", installed.packages()[, 1])) {
  install.packages("formattable", dependencies = TRUE)
}
require("formattable")

## circlize - To create a cord diagram or visualization ----
# by Gu et al. (2014)
if (!is.element("circlize", installed.packages()[, 1])) {
  install.packages("circlize", dependencies = TRUE)
}
require("circlize")

## memery - For creating data analysis related memes ----
# The memery package generates internet memes that optionally include a
# superimposed inset plot and other atypical features, combining the visual
# impact of an attention-grabbing meme with graphic results of data analysis.
if (!is.element("memery", installed.packages()[, 1])) {
  install.packages("memery", dependencies = TRUE)
}
require("memery")

## magick - For image processing in R ----
if (!is.element("magick", installed.packages()[, 1])) {
  install.packages("magick", dependencies = TRUE)
}
require("magick")

## yarrr - To create a pirate plot ----
if (!is.element("yarrr", installed.packages()[, 1])) {
  install.packages("yarrr", dependencies = TRUE)
}
require("yarrr")

## radarchart - To create interactive radar charts using ChartJS ----
if (!is.element("radarchart", installed.packages()[, 1])) {
  install.packages("radarchart", dependencies = TRUE)
}
require("radarchart")

## igraph - To create ngram network diagrams ----
if (!is.element("igraph", installed.packages()[, 1])) {
  install.packages("igraph", dependencies = TRUE)
}
require("igraph")

## wordcloud2 - For creating wordcloud by using 'wordcloud2.JS ----
if (!is.element("wordcloud2", installed.packages()[, 1])) {
  install.packages("wordcloud2", dependencies = TRUE)
}
require("wordcloud2")

## textdata - Download sentiment lexicons and labeled text data sets ----
if (!is.element("textdata", installed.packages()[, 1])) {
  install.packages("textdata", dependencies = TRUE)
}
require("textdata")

## readr - Load datasets from CSV files ----
if (!is.element("readr", installed.packages()[, 1])) {
  install.packages("readr", dependencies = TRUE)
}
require("readr")

## stringr - For processing characters in a string ----
if (!is.element("stringr", installed.packages()[, 1])) {
  install.packages("stringr", dependencies = TRUE,
                   repos = "https://cloud.r-project.org")
}
require("stringr")

## ggcorrplot - For correlation plots ----
if (!is.element("ggcorrplot", installed.packages()[, 1])) {
  install.packages("ggcorrplot", dependencies = TRUE,
                   repos = "https://cloud.r-project.org")
}
require("ggcorrplot")

## reshape2 - For formatting correlation plots ----
if (!is.element("reshape2", installed.packages()[, 1])) {
  install.packages("reshape2", dependencies = TRUE,
                   repos = "https://cloud.r-project.org")
}
require("reshape2")

## textstem - Used to lemmatize words ----
if (!is.element("textstem", installed.packages()[, 1])) {
  install.packages("textstem", dependencies = TRUE,
                   repos = "https://cloud.r-project.org")
}
require("textstem")

## hunspell - High-Performance Stemmer, Tokenizer, and Spell Checker ----
if (!is.element("hunspell", installed.packages()[, 1])) {
  install.packages("hunspell", dependencies = TRUE,
                   repos = "https://cloud.r-project.org")
}
require("hunspell")

## stringr - For processing characters in a string ----
if (!is.element("stringr", installed.packages()[, 1])) {
  install.packages("stringr", dependencies = TRUE,
                   repos = "https://cloud.r-project.org")
}
require("stringr")

## webshot2 - To ensure that HTML content is shown as a screenshot ----
if (!is.element("webshot2", installed.packages()[, 1])) {
  install.packages("webshot2", dependencies = TRUE,
                   repos = "https://cloud.r-project.org")
}
require("webshot2")

## caret - To create multivariate box and whisker plots ----
if (!is.element("caret", installed.packages()[, 1])) {
  install.packages("caret", dependencies = TRUE)
}
require("caret")

## tm - For text mining (qualitative data analysis) ----
if (!is.element("tm", installed.packages()[, 1])) {
  install.packages("tm", dependencies = TRUE)
}
require("tm")

## plotly - For interactive ggplot graphs ----
if (!is.element("plotly", installed.packages()[, 1])) {
  install.packages("plotly", dependencies = TRUE)
}
require("plotly")

## lda - For Latent Dirichlet Allocation (LDA) used for topic modelling ----
if (!is.element("lda", installed.packages()[, 1])) {
  install.packages("lda", dependencies = TRUE)
}
require("lda")

## topicmodels - For an interface to the C code for LDA models ----
if (!is.element("topicmodels", installed.packages()[, 1])) {
  install.packages("topicmodels", dependencies = TRUE)
}
require("topicmodels")
```

```{r STEP2.CustomizetheVisualizations, include=FALSE, warning=FALSE}
# STEP 2. Customize the Visualizations, Tables, and Colour Scheme ----
# The following defines a blue-grey colour scheme for the visualizations:
## shades of blue and shades of grey
blue_grey_colours_11 <- c("#27408E", "#304FAF", "#536CB5", "#6981c7", "#8da0db",
                          "#dde5ec", "#c8c9ca", "#B9BCC2", "#A7AAAF", "#888A8E",
                          "#636569")

blue_grey_colours_6 <- c("#27408E", "#304FAF", "#536CB5",
                         "#B9BCC2", "#A7AAAF", "#888A8E")

blue_grey_colours_4 <- c("#27408E", "#536CB5",
                         "#B9BCC2", "#888A8E")

blue_grey_colours_3 <- c("#6981c7", "#304FAF", "#888A8E")

blue_grey_colours_2 <- c("#27408E",
                         "#888A8E")

blue_grey_colours_1 <- c("#6981c7")

# Custom theme for visualizations
blue_grey_theme <- function() {
  theme(
    axis.ticks = element_line(
                              linewidth = 1, linetype = "dashed",
                              lineend = NULL, color = "#dfdede",
                              arrow = NULL, inherit.blank = FALSE),
    axis.text = element_text(
                             face = "plain", color = "#3f3f41",
                             size = 12, hjust = 0.5),
    axis.title = element_text(face = "plain", color = "#3f3f41",
                              size = 12, hjust = 0.5),
    plot.title = element_text(face = "bold", color = "#3f3f41",
                              size = 12, hjust = 0.5),
    panel.grid = element_line(
                              linewidth = 0.1, linetype = "dashed",
                              lineend = NULL, color = "#dfdede",
                              arrow = NULL, inherit.blank = FALSE),
    panel.background = element_rect(fill = "#f3eeee"),
    legend.title = element_text(face = "plain", color = "#3f3f41",
                                size = 12, hjust = 0),
    legend.position = "right"
  )
}

# Customize the text tables for consistency using HTML formatting
my_kable_styling <- function(dat, caption) {
  knitr::kable(dat, "html", escape = FALSE, caption = caption) %>%
    kableExtra::kable_styling(bootstrap_options = c("striped", "condensed", "bordered"), full_width = FALSE)
}
```

```{r ImportDataset, include=FALSE, warning=FALSE}
# STEP 3. Load the Dataset ----
library(readr)
course_evaluation_dataset <- read_csv("data/Mid_Term_Course_Evaluation_Form_Preprocessed.csv", 
    col_types = cols(`Submitted on:` = col_datetime(format = "%d/%m/%Y %H:%M:%S"), 
        Course = col_character(), Group = col_factor(levels = c("20230821-20231128-BI2-BBIT4.2-A", 
            "20230821-20231128-BI2-BBIT4.2-B", 
            "20230821-20231128-BI2-BBIT4.2-C")), 
        Username = col_integer(), Gender = col_factor(levels = c("Male", 
            "Female")), `Q01_Class Demographics` = col_factor(levels = c("1 : Group A - Regular", 
            "2 : Group A - Exempt", "3 : Group B - Regular", 
            "4 : Group B - Exempt", "5 : Group C - Regular", 
            "6 : Group C - Exempt"))))
```

```{r evaluation_rating_per_question_per_group_per_gender, warning=FALSE, include=FALSE}
# STEP 4. Evaluation Rating per Group (1st) and per Gender (2nd) ----
## Average per Question per Group ----
evaluation_rating_per_question_per_group_per_gender <- course_evaluation_dataset %>%
  rename(`Class Group` = `Q01_Class Demographics`) %>%
  filter(!is.na(`Q02_General Questions->A - 11. I use the eLearning material posted`)) %>%
  rowwise() %>%
  
  # average_course_evaluation_rating
  mutate(average_course_evaluation_rating = mean(c(`Q02_General Questions->A - 1. I am enjoying the subject`, `Q02_General Questions->A - 2. Classes start and end on time`, `Q02_General Questions->A - 3. The learning environment is participative, involves learning by doing and is group-based`, `Q02_General Questions->A - 4. The subject content is delivered according to the course outline and meets my expectations`, `Q02_General Questions->A - 5. The topics are clear and logically developed`, `Q02_General Questions->A - 6. I am developing my oral and writing skills`, `Q02_General Questions->A - 7. I am developing my reflective and critical reasoning skills`, `Q02_General Questions->A - 8. The assessment methods are assisting me to learn`, `Q02_General Questions->A - 9. I receive relevant feedback`, `Q02_General Questions->A - 10. I read the recommended readings and notes`, `Q02_General Questions->A - 11. I use the eLearning material posted`))) %>%
  
  # average_level_of_learning_achieved
  mutate(average_level_of_learning_achieved = mean(c(`Q03_Level of Learning Achieved->B - 1. Concept 1 of 4 - Ensemble Methods for Predictive Analytics`, `Q03_Level of Learning Achieved->B - 2. Concept 2 of 4 - Predictive Modelling Using R`))) %>%

  # average_quality_of_teaching_strategies  
  mutate(average_quality_of_teaching_strategies = mean(c(`Q04_Quality of Teaching Strategies->C - 1. Labs with comments that describe each step to be followed`, `Q04_Quality of Teaching Strategies->C - 2. Labs that require you to put in effort to make a submission related to the content of the lab`, `Q04_Quality of Teaching Strategies->C - 3. Labs that require you to use Git to work in a team`, `Q04_Quality of Teaching Strategies->C - 4. Labs that require you to work alone`, `Q04_Quality of Teaching Strategies->C - 5. The quality of the lectures given (quality measured by the breadth (the full span of knowledge of a subject) and depth (the extent to which specific topics are focused upon, amplified, and explored) of learning - NOT quality measured by how fun/comical/lively the lectures are)`, `Q04_Quality of Teaching Strategies->C - 6. The recordings of online classes`, `Q04_Quality of Teaching Strategies->C - 7. Online classes in general`, `Q04_Quality of Teaching Strategies->C - 8. Face-to-Face classes in general`))) %>%
  
  group_by(`Class Group`, `Gender`) %>%
  summarise(
    `A. I am enjoying the subject` =
      mean(`Q02_General Questions->A - 1. I am enjoying the subject`),
    `B. Classes start and end on time` =
      mean(`Q02_General Questions->A - 2. Classes start and end on time`),
    `C. The learning environment is participative, involves learning by doing and is group-based` =
      mean(`Q02_General Questions->A - 3. The learning environment is participative, involves learning by doing and is group-based`),
    `D. The subject content is delivered according to the course outline and meets my expectations` =
      mean(`Q02_General Questions->A - 4. The subject content is delivered according to the course outline and meets my expectations`),
    `E. The topics are clear and logically developed` =
      mean(`Q02_General Questions->A - 5. The topics are clear and logically developed`),
    `F. I am developing my oral and writing skills` =
      mean(`Q02_General Questions->A - 6. I am developing my oral and writing skills`),
    `G. I am developing my reflective and critical reasoning skills` =
      mean(`Q02_General Questions->A - 7. I am developing my reflective and critical reasoning skills`),
    `H. The assessment methods are assisting me to learn` =
      mean(`Q02_General Questions->A - 8. The assessment methods are assisting me to learn`),
    `I. I receive relevant feedback` =
      mean(`Q02_General Questions->A - 9. I receive relevant feedback`),
    `J. I read the recommended readings and notes` =
      mean(`Q02_General Questions->A - 10. I read the recommended readings and notes`),
    `K. I use the eLearning material posted` =
      mean(`Q02_General Questions->A - 11. I use the eLearning material posted`),
     `L. Average Quality of Teaching Strategies` =
      mean(average_quality_of_teaching_strategies),
     `M. Average Level of Learning Achieved` =
      mean(average_level_of_learning_achieved),
     `N. Average Course Evaluation Rating` =
      mean(average_course_evaluation_rating)
  ) %>%
  # If we had to sort the results
  # arrange(`Mean Average Course Evaluation Rating`) %>%
  select(
    `Class Group`,
    `Gender`,
    `A. I am enjoying the subject`,
    `B. Classes start and end on time`,
    `C. The learning environment is participative, involves learning by doing and is group-based`,
    `D. The subject content is delivered according to the course outline and meets my expectations`,
    `E. The topics are clear and logically developed`,
    `F. I am developing my oral and writing skills`,
    `G. I am developing my reflective and critical reasoning skills`,
    `H. The assessment methods are assisting me to learn`,
    `I. I receive relevant feedback`,
    `J. I read the recommended readings and notes`,
    `K. I use the eLearning material posted`,
    `L. Average Quality of Teaching Strategies`,
    `M. Average Level of Learning Achieved`,
    `N. Average Course Evaluation Rating`
  )
```

```{r OverallScore, include=FALSE}
overall_score <- course_evaluation_dataset %>%
  rename(`Class Group` = `Q01_Class Demographics`) %>%
  filter(!is.na(`Q02_General Questions->A - 11. I use the eLearning material posted`)) %>%
  rowwise() %>%
  
  # average_course_evaluation_rating
  mutate(average_course_evaluation_rating = mean(c(`Q02_General Questions->A - 1. I am enjoying the subject`, `Q02_General Questions->A - 2. Classes start and end on time`, `Q02_General Questions->A - 3. The learning environment is participative, involves learning by doing and is group-based`, `Q02_General Questions->A - 4. The subject content is delivered according to the course outline and meets my expectations`, `Q02_General Questions->A - 5. The topics are clear and logically developed`, `Q02_General Questions->A - 6. I am developing my oral and writing skills`, `Q02_General Questions->A - 7. I am developing my reflective and critical reasoning skills`, `Q02_General Questions->A - 8. The assessment methods are assisting me to learn`, `Q02_General Questions->A - 9. I receive relevant feedback`, `Q02_General Questions->A - 10. I read the recommended readings and notes`, `Q02_General Questions->A - 11. I use the eLearning material posted`))) %>%
  
  # average_level_of_learning_achieved
  mutate(average_level_of_learning_achieved = mean(c(`Q03_Level of Learning Achieved->B - 1. Concept 1 of 4 - Ensemble Methods for Predictive Analytics`, `Q03_Level of Learning Achieved->B - 2. Concept 2 of 4 - Predictive Modelling Using R`))) %>%

  # average_quality_of_teaching_strategies  
  mutate(average_quality_of_teaching_strategies = mean(c(`Q04_Quality of Teaching Strategies->C - 1. Labs with comments that describe each step to be followed`, `Q04_Quality of Teaching Strategies->C - 2. Labs that require you to put in effort to make a submission related to the content of the lab`, `Q04_Quality of Teaching Strategies->C - 3. Labs that require you to use Git to work in a team`, `Q04_Quality of Teaching Strategies->C - 4. Labs that require you to work alone`, `Q04_Quality of Teaching Strategies->C - 5. The quality of the lectures given (quality measured by the breadth (the full span of knowledge of a subject) and depth (the extent to which specific topics are focused upon, amplified, and explored) of learning - NOT quality measured by how fun/comical/lively the lectures are)`, `Q04_Quality of Teaching Strategies->C - 6. The recordings of online classes`, `Q04_Quality of Teaching Strategies->C - 7. Online classes in general`, `Q04_Quality of Teaching Strategies->C - 8. Face-to-Face classes in general`))) %>%
  ungroup() %>%
  summarise(mean_score = mean(average_course_evaluation_rating), median_score = median(average_course_evaluation_rating)) %>%
  select(mean_score, median_score)

percentage_overall_score <- (overall_score$mean_score / 5) * 100

df <- data.frame(
  overall_score$mean_score,
  percentage_overall_score,
  overall_score$median_score
)
colnames(df) <- c("Mean Score", "Percentage", "Median Score")
```

# Course Evaluation Score

```{r TabularResultOfOverallScore, echo=FALSE, warning=FALSE, results='asis'}
formatted_mean_score <- sprintf("Mean Course Evaluation Score = %.4f", df$`Mean Score`)
cat(formatted_mean_score)
cat(" / 5")

formatted_percentage_mean_score <- sprintf("\n\nPercentage Mean Course Evaluation Score = %.2f", df$Percentage)
cat(formatted_percentage_mean_score)
cat("%")

formatted_median_score <- sprintf("\n\nMedian Course Evaluation Score = %.4f", df$`Median Score`)
cat(formatted_median_score)
cat(" / 5")
```

------------------------------------------------------------------------

```{r evaluation_rating_per_question_per_eLearning_class_per_gender, include=FALSE, warning=FALSE}
# STEP 5. Evaluation Rating per e-learning Class Group (1st) and per Gender (2nd) ----
# Get the average course evaluation rating per class group on e-learning
# (first grouping) and per gender (second grouping) 
evaluation_rating_per_question_per_eLearning_class_per_gender <- course_evaluation_dataset %>%
  rename(`Class Group` = `Q01_Class Demographics`) %>%
  filter(!is.na(`Q02_General Questions->A - 11. I use the eLearning material posted`)) %>%
  rowwise() %>%
  
  # average_course_evaluation_rating
  mutate(average_course_evaluation_rating = mean(c(`Q02_General Questions->A - 1. I am enjoying the subject`, `Q02_General Questions->A - 2. Classes start and end on time`, `Q02_General Questions->A - 3. The learning environment is participative, involves learning by doing and is group-based`, `Q02_General Questions->A - 4. The subject content is delivered according to the course outline and meets my expectations`, `Q02_General Questions->A - 5. The topics are clear and logically developed`, `Q02_General Questions->A - 6. I am developing my oral and writing skills`, `Q02_General Questions->A - 7. I am developing my reflective and critical reasoning skills`, `Q02_General Questions->A - 8. The assessment methods are assisting me to learn`, `Q02_General Questions->A - 9. I receive relevant feedback`, `Q02_General Questions->A - 10. I read the recommended readings and notes`, `Q02_General Questions->A - 11. I use the eLearning material posted`))) %>%
  
  # average_level_of_learning_achieved
  mutate(average_level_of_learning_achieved = mean(c(`Q03_Level of Learning Achieved->B - 1. Concept 1 of 4 - Ensemble Methods for Predictive Analytics`, `Q03_Level of Learning Achieved->B - 2. Concept 2 of 4 - Predictive Modelling Using R`))) %>%

  # average_quality_of_teaching_strategies  
  mutate(average_quality_of_teaching_strategies = mean(c(`Q04_Quality of Teaching Strategies->C - 1. Labs with comments that describe each step to be followed`, `Q04_Quality of Teaching Strategies->C - 2. Labs that require you to put in effort to make a submission related to the content of the lab`, `Q04_Quality of Teaching Strategies->C - 3. Labs that require you to use Git to work in a team`, `Q04_Quality of Teaching Strategies->C - 4. Labs that require you to work alone`, `Q04_Quality of Teaching Strategies->C - 5. The quality of the lectures given (quality measured by the breadth (the full span of knowledge of a subject) and depth (the extent to which specific topics are focused upon, amplified, and explored) of learning - NOT quality measured by how fun/comical/lively the lectures are)`, `Q04_Quality of Teaching Strategies->C - 6. The recordings of online classes`, `Q04_Quality of Teaching Strategies->C - 7. Online classes in general`, `Q04_Quality of Teaching Strategies->C - 8. Face-to-Face classes in general`))) %>%
  
  group_by(`Group`, `Gender`) %>%
  summarise(
    `A. I am enjoying the subject` =
      mean(`Q02_General Questions->A - 1. I am enjoying the subject`),
    `B. Classes start and end on time` =
      mean(`Q02_General Questions->A - 2. Classes start and end on time`),
    `C. The learning environment is participative, involves learning by doing and is group-based` =
      mean(`Q02_General Questions->A - 3. The learning environment is participative, involves learning by doing and is group-based`),
    `D. The subject content is delivered according to the course outline and meets my expectations` =
      mean(`Q02_General Questions->A - 4. The subject content is delivered according to the course outline and meets my expectations`),
    `E. The topics are clear and logically developed` =
      mean(`Q02_General Questions->A - 5. The topics are clear and logically developed`),
    `F. I am developing my oral and writing skills` =
      mean(`Q02_General Questions->A - 6. I am developing my oral and writing skills`),
    `G. I am developing my reflective and critical reasoning skills` =
      mean(`Q02_General Questions->A - 7. I am developing my reflective and critical reasoning skills`),
    `H. The assessment methods are assisting me to learn` =
      mean(`Q02_General Questions->A - 8. The assessment methods are assisting me to learn`),
    `I. I receive relevant feedback` =
      mean(`Q02_General Questions->A - 9. I receive relevant feedback`),
    `J. I read the recommended readings and notes` =
      mean(`Q02_General Questions->A - 10. I read the recommended readings and notes`),
    `K. I use the eLearning material posted` =
      mean(`Q02_General Questions->A - 11. I use the eLearning material posted`),
     `L. Average Quality of Teaching Strategies` =
      mean(average_quality_of_teaching_strategies),
     `M. Average Level of Learning Achieved` =
      mean(average_level_of_learning_achieved),
     `N. Average Course Evaluation Rating` =
      mean(average_course_evaluation_rating)
  ) %>%
  # If we had to sort the results
  # arrange(`Mean Average Course Evaluation Rating`) %>%
  select(
    `Group`,
    `Gender`,
    `A. I am enjoying the subject`,
    `B. Classes start and end on time`,
    `C. The learning environment is participative, involves learning by doing and is group-based`,
    `D. The subject content is delivered according to the course outline and meets my expectations`,
    `E. The topics are clear and logically developed`,
    `F. I am developing my oral and writing skills`,
    `G. I am developing my reflective and critical reasoning skills`,
    `H. The assessment methods are assisting me to learn`,
    `I. I receive relevant feedback`,
    `J. I read the recommended readings and notes`,
    `K. I use the eLearning material posted`,
    `L. Average Quality of Teaching Strategies`,
    `M. Average Level of Learning Achieved`,
    `N. Average Course Evaluation Rating`
  )
```

```{r evaluation_rating_per_question_per_gender_per_group, include=FALSE, warning=FALSE}
# STEP 6. Evaluation Rating per Gender (1st) and per Group (2nd) ----
# The average course evaluation rating per gender (first grouping) and per
# group (second grouping)
evaluation_rating_per_question_per_gender_per_group <- course_evaluation_dataset %>%
  rename(`Class Group` = `Q01_Class Demographics`) %>%
  filter(!is.na(`Q02_General Questions->A - 11. I use the eLearning material posted`)) %>%
  rowwise() %>%
  
  # average_course_evaluation_rating
  mutate(average_course_evaluation_rating = mean(c(`Q02_General Questions->A - 1. I am enjoying the subject`, `Q02_General Questions->A - 2. Classes start and end on time`, `Q02_General Questions->A - 3. The learning environment is participative, involves learning by doing and is group-based`, `Q02_General Questions->A - 4. The subject content is delivered according to the course outline and meets my expectations`, `Q02_General Questions->A - 5. The topics are clear and logically developed`, `Q02_General Questions->A - 6. I am developing my oral and writing skills`, `Q02_General Questions->A - 7. I am developing my reflective and critical reasoning skills`, `Q02_General Questions->A - 8. The assessment methods are assisting me to learn`, `Q02_General Questions->A - 9. I receive relevant feedback`, `Q02_General Questions->A - 10. I read the recommended readings and notes`, `Q02_General Questions->A - 11. I use the eLearning material posted`))) %>%
  
  # average_level_of_learning_achieved
  mutate(average_level_of_learning_achieved = mean(c(`Q03_Level of Learning Achieved->B - 1. Concept 1 of 4 - Ensemble Methods for Predictive Analytics`, `Q03_Level of Learning Achieved->B - 2. Concept 2 of 4 - Predictive Modelling Using R`))) %>%

  # average_quality_of_teaching_strategies  
  mutate(average_quality_of_teaching_strategies = mean(c(`Q04_Quality of Teaching Strategies->C - 1. Labs with comments that describe each step to be followed`, `Q04_Quality of Teaching Strategies->C - 2. Labs that require you to put in effort to make a submission related to the content of the lab`, `Q04_Quality of Teaching Strategies->C - 3. Labs that require you to use Git to work in a team`, `Q04_Quality of Teaching Strategies->C - 4. Labs that require you to work alone`, `Q04_Quality of Teaching Strategies->C - 5. The quality of the lectures given (quality measured by the breadth (the full span of knowledge of a subject) and depth (the extent to which specific topics are focused upon, amplified, and explored) of learning - NOT quality measured by how fun/comical/lively the lectures are)`, `Q04_Quality of Teaching Strategies->C - 6. The recordings of online classes`, `Q04_Quality of Teaching Strategies->C - 7. Online classes in general`, `Q04_Quality of Teaching Strategies->C - 8. Face-to-Face classes in general`))) %>%
  
  group_by(`Gender`, `Class Group`) %>%
  summarise(
    `A. I am enjoying the subject` =
      mean(`Q02_General Questions->A - 1. I am enjoying the subject`),
    `B. Classes start and end on time` =
      mean(`Q02_General Questions->A - 2. Classes start and end on time`),
    `C. The learning environment is participative, involves learning by doing and is group-based` =
      mean(`Q02_General Questions->A - 3. The learning environment is participative, involves learning by doing and is group-based`),
    `D. The subject content is delivered according to the course outline and meets my expectations` =
      mean(`Q02_General Questions->A - 4. The subject content is delivered according to the course outline and meets my expectations`),
    `E. The topics are clear and logically developed` =
      mean(`Q02_General Questions->A - 5. The topics are clear and logically developed`),
    `F. I am developing my oral and writing skills` =
      mean(`Q02_General Questions->A - 6. I am developing my oral and writing skills`),
    `G. I am developing my reflective and critical reasoning skills` =
      mean(`Q02_General Questions->A - 7. I am developing my reflective and critical reasoning skills`),
    `H. The assessment methods are assisting me to learn` =
      mean(`Q02_General Questions->A - 8. The assessment methods are assisting me to learn`),
    `I. I receive relevant feedback` =
      mean(`Q02_General Questions->A - 9. I receive relevant feedback`),
    `J. I read the recommended readings and notes` =
      mean(`Q02_General Questions->A - 10. I read the recommended readings and notes`),
    `K. I use the eLearning material posted` =
      mean(`Q02_General Questions->A - 11. I use the eLearning material posted`),
     `L. Average Quality of Teaching Strategies` =
      mean(average_quality_of_teaching_strategies),
     `M. Average Level of Learning Achieved` =
      mean(average_level_of_learning_achieved),
     `N. Average Course Evaluation Rating` =
      mean(average_course_evaluation_rating)
  ) %>%
  # If we had to sort the results
  # arrange(`Mean Average Course Evaluation Rating`) %>%
  select(
    `Gender`,
    `Class Group`,
    `A. I am enjoying the subject`,
    `B. Classes start and end on time`,
    `C. The learning environment is participative, involves learning by doing and is group-based`,
    `D. The subject content is delivered according to the course outline and meets my expectations`,
    `E. The topics are clear and logically developed`,
    `F. I am developing my oral and writing skills`,
    `G. I am developing my reflective and critical reasoning skills`,
    `H. The assessment methods are assisting me to learn`,
    `I. I receive relevant feedback`,
    `J. I read the recommended readings and notes`,
    `K. I use the eLearning material posted`,
    `L. Average Quality of Teaching Strategies`,
    `M. Average Level of Learning Achieved`,
    `N. Average Course Evaluation Rating`
  )
```

```{r Transpose, include=FALSE, warning=FALSE}
# STEP 7. Transpose the Data  for Easier Visualization ----
# We then transpose the data frame (for the group by class group and group by gender options)

# Group by Class Group
evaluation_rating_per_question_per_group_long_data <- evaluation_rating_per_question_per_group_per_gender %>%
  select(-`Gender`) %>%
  pivot_longer(
               cols = -`Class Group`,
               names_to = "Evaluation Question",
               values_to = "Mean Value")

# Group by eLearning Class
evaluation_rating_per_question_per_class_long_data <- evaluation_rating_per_question_per_eLearning_class_per_gender %>%
  select(-`Gender`) %>%
  pivot_longer(
               cols = -`Group`,
               names_to = "Evaluation Question",
               values_to = "Mean Value")

# Group by Gender
evaluation_rating_per_question_per_gender_long_data <- evaluation_rating_per_question_per_gender_per_group %>%
  select(-`Class Group`) %>%
  pivot_longer(
               cols = -`Gender`,
               names_to = "Evaluation Question",
               values_to = "Mean Value")
```

\newpage

# Quantitative Data Analysis

## Course Evaluation Scores per Group

```{r ProcessStringsBeforePlotting, include=FALSE, warning=FALSE}
# This is done to enable word wrapping when the plot is created
# Per Group
evaluation_rating_per_question_per_group_long_data$`Evaluation Question` <- 
  str_wrap(evaluation_rating_per_question_per_group_long_data$`Evaluation Question`, # nolint
         width = 30)

# Per e-Learning Class
evaluation_rating_per_question_per_class_long_data$`Evaluation Question` <- 
  str_wrap(evaluation_rating_per_question_per_class_long_data$`Evaluation Question`, # nolint
         width = 30)

# Per Gender
evaluation_rating_per_question_per_gender_long_data$`Evaluation Question` <- 
  str_wrap(evaluation_rating_per_question_per_gender_long_data$`Evaluation Question`, # nolint
         width = 30)
```

\newpage

The **"Average Course Evaluation Rating"** variable in the plot below indicates the score **per group** with a baseline of 4/5.

```{r VisualizationsForCourseEvaluationResultsperClassGroup, echo=FALSE, warning=FALSE}
### Visualizations (Grouped Vertical Bar Chart) ----
# Per Group
ggplot(evaluation_rating_per_question_per_class_long_data,
       aes(fill = `Group`, y = `Mean Value`, x = `Evaluation Question`,
           label = `Mean Value`)) +
  geom_bar(position = "dodge", stat = "identity") +
  coord_flip() +  # Flip the coordinates to make it vertical
  labs(title = "Standard Course Evaluation Score per Question per Group",
       x = "Standard Course Evaluation Questions", y = "Mean Value") +
  scale_fill_manual(values = blue_grey_colours_3) +
  blue_grey_theme() +
  geom_hline(yintercept = 4, color = "#b90c0c",
             linetype = "dashed", size = 1)
```

\newpage

The **"Average Course Evaluation Rating"** variable in the plot below indicates the score **per gender** with a baseline of 4/5.

```{r VisualizationsForCourseEvaluationResultsperGender, echo=FALSE, warning=FALSE}
### Visualizations (Grouped Vertical Bar Chart) ----
# Per Group
ggplot(evaluation_rating_per_question_per_gender_long_data,
       aes(fill = `Gender`, y = `Mean Value`, x = `Evaluation Question`,
           label = `Mean Value`)) +
  geom_bar(position = "dodge", stat = "identity") +
  coord_flip() +  # Flip the coordinates to make it vertical
  labs(title = "Standard Course Evaluation Score per Question per Gender",
       x = "Standard Course Evaluation Questions", y = "Mean Value") +
  scale_fill_manual(values = blue_grey_colours_2) +
  blue_grey_theme() +
  geom_hline(yintercept = 4, color = "#b90c0c",
             linetype = "dashed", size = 1)
```

\newpage

The plot below presents a drill-down of the class group into **regular and exempt** students:

```{r VisualizationsForCourseEvaluationResultsperGroup, echo=FALSE, warning=FALSE}
### Visualizations (Grouped Vertical Bar Chart) ----
# Per Group
ggplot(evaluation_rating_per_question_per_group_long_data,
       aes(fill = `Class Group`, y = `Mean Value`, x = `Evaluation Question`,
           label = `Mean Value`)) +
  geom_bar(position = "dodge", stat = "identity") +
  coord_flip() +  # Flip the coordinates to make it vertical
  labs(title = "Standard Course Evaluation Score per Question per Gender",
       x = "Standard Course Evaluation Questions", y = "Mean Value") +
  scale_fill_manual(values = blue_grey_colours_6) +
  blue_grey_theme() +
  geom_hline(yintercept = 4, color = "#b90c0c",
             linetype = "dashed", size = 1)
```

\newpage

## Correlations

The following variables have been renamed to fit the correlation plots:

-   \`A. Enjoying Subject\` = \`Q02_General Questions-\>A - 1. I am enjoying the subject\`,

-   \`B. Classes Start-End\` = \`Q02_General Questions-\>A - 2. Classes start and end on time\`,

-   \`C. Learning Environment\` = \`Q02_General Questions-\>A - 3. The learning environment is participative, involves learning by doing and is group-based\`,

-   \`D. Content Delivery\` = \`Q02_General Questions-\>A - 4. The subject content is delivered according to the course outline and meets my expectations\`,

-   \`E. Clear Topics\` = \`Q02_General Questions-\>A - 5. The topics are clear and logically developed\`,

-   \`F. Oral and Writing\` = \`Q02_General Questions-\>A - 6. I am developing my oral and writing skills\`,

-   \`G. Critical Thinking\` = \`Q02_General Questions-\>A - 7. I am developing my reflective and critical reasoning skills\`,

-   \`H. Assessment Methods\` = \`Q02_General Questions-\>A - 8. The assessment methods are assisting me to learn\`,

-   \`I. Relevant Feedback\` = \`Q02_General Questions-\>A - 9. I receive relevant feedback\`,

-   \`J. Read Recommendations\` = \`Q02_General Questions-\>A - 10. I read the recommended readings and notes\`,

-   \`L. eLearning Material\` = \`Q02_General Questions-\>A - 11. I use the eLearning material posted\`,

-   \`Understood Concept 1\` = \`Q03_Level of Learning Achieved-\>B - 1. Concept 1 of 4 - Ensemble Methods for Predictive Analytics\`,

-   \`Understood Concept 2\` = \`Q03_Level of Learning Achieved-\>B - 2. Concept 2 of 4 - Predictive Modelling Using R\`,

-   \`Teaching - Labs\` = \`Q04_Quality of Teaching Strategies-\>C - 1. Labs with comments that describe each step to be followed\`,

-   \`Labs with Submission\` = \`Q04_Quality of Teaching Strategies-\>C - 2. Labs that require you to put in effort to make a submission related to the content of the lab\`,

-   \`Git in Teams\` =\`Q04_Quality of Teaching Strategies-\>C - 3. Labs that require you to use Git to work in a team\`,

-   \`Solo Labs\` = \`Q04_Quality of Teaching Strategies-\>C - 4. Labs that require you to work alone\`,

-   \`Quality of Lectures\` = \`Q04_Quality of Teaching Strategies-\>C - 5. The quality of the lectures given (quality measured by the breadth (the full span of knowledge of a subject) and depth (the extent to which specific topics are focused upon, amplified, and explored) of learning - NOT quality measured by how fun/comical/lively the lectures are)\`,

-   \`Recordings of Classes\` = \`Q04_Quality of Teaching Strategies-\>C - 6. The recordings of online classes\`,

-   \`Online Classes\` = \`Q04_Quality of Teaching Strategies-\>C - 7. Online classes in general\`,

-   \`Physical Classes\` = \`Q04_Quality of Teaching Strategies-\>C - 8. Face-to-Face classes in general\`

\newpage

The general correlation values are presented below:

```{r CorrelationMatrixWithoutFigures, echo=FALSE, fig.height=10}
course_evaluation_dataset_short_names <- course_evaluation_dataset %>%
  rename(
    `A. Enjoying Subject` = `Q02_General Questions->A - 1. I am enjoying the subject`,
    `B. Classes Start-End` = `Q02_General Questions->A - 2. Classes start and end on time`,
    `C. Learning Environment` = `Q02_General Questions->A - 3. The learning environment is participative, involves learning by doing and is group-based`,
    `D. Content Delivery` = `Q02_General Questions->A - 4. The subject content is delivered according to the course outline and meets my expectations`,
    `E. Clear Topics` = `Q02_General Questions->A - 5. The topics are clear and logically developed`,
     `F. Oral and Writing` = `Q02_General Questions->A - 6. I am developing my oral and writing skills`,
    `G. Critical Thinking` = `Q02_General Questions->A - 7. I am developing my reflective and critical reasoning skills`,
     `H. Assessment Methods` = `Q02_General Questions->A - 8. The assessment methods are assisting me to learn`,
    `I. Relevant Feedback` = `Q02_General Questions->A - 9. I receive relevant feedback`,
    `J. Read Recommendations` = `Q02_General Questions->A - 10. I read the recommended readings and notes`,
    `L. eLearning Material` = `Q02_General Questions->A - 11. I use the eLearning material posted`,
    `Understood Concept 1` = `Q03_Level of Learning Achieved->B - 1. Concept 1 of 4 - Ensemble Methods for Predictive Analytics`,
    `Understood Concept 2` = `Q03_Level of Learning Achieved->B - 2. Concept 2 of 4 - Predictive Modelling Using R`,
    `Teaching - Labs` = `Q04_Quality of Teaching Strategies->C - 1. Labs with comments that describe each step to be followed`,
    `Labs with Submission` = `Q04_Quality of Teaching Strategies->C - 2. Labs that require you to put in effort to make a submission related to the content of the lab`,
    `Git in Teams` =`Q04_Quality of Teaching Strategies->C - 3. Labs that require you to use Git to work in a team`,
    `Solo Labs` = `Q04_Quality of Teaching Strategies->C - 4. Labs that require you to work alone`,
    `Quality of Lectures` = `Q04_Quality of Teaching Strategies->C - 5. The quality of the lectures given (quality measured by the breadth (the full span of knowledge of a subject) and depth (the extent to which specific topics are focused upon, amplified, and explored) of learning - NOT quality measured by how fun/comical/lively the lectures are)`,
    `Recordings of Classes` = `Q04_Quality of Teaching Strategies->C - 6. The recordings of online classes`,
    `Online Classes` = `Q04_Quality of Teaching Strategies->C - 7. Online classes in general`,
    `Physical Classes` = `Q04_Quality of Teaching Strategies->C - 8. Face-to-Face classes in general`
    ) %>% 
  select(
    `Absenteeism`,
    `A. Enjoying Subject`,
    `B. Classes Start-End`,
    `C. Learning Environment`,
    `D. Content Delivery`,
    `E. Clear Topics`,
    `F. Oral and Writing`,
    `G. Critical Thinking`,
    `H. Assessment Methods`,
    `I. Relevant Feedback`,
    `J. Read Recommendations`,
    `L. eLearning Material`,
    `Understood Concept 1`,
    `Understood Concept 2`,
    `Labs with Submission`,
    `Git in Teams`,
    `Solo Labs`,
    `Quality of Lectures`,
    `Recordings of Classes`,
    `Online Classes`,
    `Physical Classes`
  )

ggcorrplot(cor(course_evaluation_dataset_short_names))

```

```{r CorrelationMatrixWithFigures, eval=FALSE, include=FALSE}
# \newpage
# 
# The specific correlation values are presented below:

# Create a correlation matrix
corr_matrix <- cor(course_evaluation_dataset_short_names)

# Create a ggplot2 plot for the correlation matrix
p <- ggplot2::ggplot(data = reshape2::melt(corr_matrix),
                     ggplot2::aes(Var1, Var2, fill = value)) +
  ggplot2::geom_tile() +
  ggplot2::geom_text(ggplot2::aes(label = label_wrap(label, width = 10)), size = 4) +  # Customize label_wrap width
  ggplot2::scale_fill_gradient2(low = "red", high = "green") +
  ggplot2::theme_minimal() +
  ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, hjust = 1))

ggcorrplot(corr_matrix, hc.order = TRUE, type = "lower", lab = TRUE)
```

### Interesting Correlations

The following are hypothetical statements given that "correlation does not imply causation".

-   **.73 correlation** between "I am developing my oral and writing skills" and "I am developing my reflective and critical reasoning skills": *Consider writing as formalized thinking.*

-   **.71 correlation** between "The assessment methods are assisting me to learn" and "I am developing my reflective and critical reasoning skills": *The more effort students put into the assessment, the more they develop their reflective and critical reasoning skills.*

-   **.67 correlation** between "I am enjoying the subject" and "I am developing my reflective and critical reasoning skills": *The more a student enjoys the subject, the more they consider their reflective and critical reasoning skills as developing.*

-   **.65 correlation** between "The assessment methods are assisting me to learn" and "I am enjoying the subject": *The more interesting/challenging the assessment methods, the more students enjoy the course.*

-   **.63 correlation** between "Labs that require you to use Git to work in a team" and "Labs that require you to put in effort to make a submission related to the content of the lab": *The more students appreciate the use of Git for working in teams, the more they appreciate labs that require a submission to be made.*

-   **.62 correlation** between "The subject content is delivered according to the course outline and meets my expectations" and "The topics are clear and logically developed": *The more the course outline is followed, the clearer and more logically developed the topics are.*

-   **-.32 correlation** between "Concept 1 of 4 - Ensemble Methods for Predictive Analytics" and "Absenteeism": *Students who started the semester late (high absenteeism), had a harder time understanding concept 1 which was covered at the beginning of the semester.*

-   **-.36 correlation** between "I use the e-learning material posted" and "absenteeism": *The higher the number of classes missed, the lower the student's engagement with content posted on e-learning*

Below are the two most extreme correlations:

```{r DrillDownCorr1, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(course_evaluation_dataset,
       aes(x = `Q02_General Questions->A - 6. I am developing my oral and writing skills`, y = `Q02_General Questions->A - 7. I am developing my reflective and critical reasoning skills`, shape = Gender, color = Gender)) +
  geom_point() +
  geom_smooth(method = lm)
```

```{r DrillDownCorr2, echo=FALSE, message=FALSE, warning=FALSE}
ggplot(course_evaluation_dataset,
       aes(x = `Q02_General Questions->A - 11. I use the eLearning material posted`, y = Absenteeism, shape = Gender, color = Gender)) +
  geom_point() +
  geom_smooth(method = lm)
```

\newpage

### Absenteeism Percentage

The lower the absenteeism, the more a student makes use of the e-learning materials posted. And the more a student makes use of the e-learning materials posted, the higher their overall grade in the course.

With this in mind, a further investigation of the **absenteeism percentage** is presented below.

Absenteeism by general class group:

```{r AbsenteeismBoxandWhiskerGroup, echo=FALSE, fig.height=5, message=FALSE, warning=FALSE}
featurePlot(x = course_evaluation_dataset$Absenteeism, y = course_evaluation_dataset$Group, plot = "box")
```

\newpage

Absenteeism by specific class group:

```{r AbsenteeismBoxandWhiskerSpecificGroup, echo=FALSE, fig.height=8, message=FALSE, warning=FALSE}
featurePlot(x = course_evaluation_dataset$Absenteeism, y = course_evaluation_dataset$`Q01_Class Demographics`, plot = "box")
```

\newpage

Absenteeism by gender:

```{r AbsenteeismBoxandWhiskerGender, echo=FALSE, fig.height=8, message=FALSE, warning=FALSE}
featurePlot(x = course_evaluation_dataset$Absenteeism, y = course_evaluation_dataset$Gender, plot = "box")
```

\newpage

# Qualitative Data Analysis

```{r QualitativeDatareProcessing, message=FALSE, warning=FALSE, include=FALSE}
## Average per Question per Group ----
evaluation_likes_and_wishes <- course_evaluation_dataset %>%
  rename(`Class Group` = `Q01_Class Demographics`) %>%
  rename(`Likes` = `Q05_Likes->D - 1. Write two things you like about the teaching and learning in this unit so far.`) %>%
  rename(`Wishes` = `Q05_Wishes->D - 2. Write at least one recommendation to improve the teaching and learning in this unit (for the remaining weeks in the semester)`) %>%
  filter(!is.na(`Q02_General Questions->A - 11. I use the eLearning material posted`)) %>%
  rowwise() %>%
  
  # average_course_evaluation_rating
  mutate(average_course_evaluation_rating = mean(c(`Q02_General Questions->A - 1. I am enjoying the subject`, `Q02_General Questions->A - 2. Classes start and end on time`, `Q02_General Questions->A - 3. The learning environment is participative, involves learning by doing and is group-based`, `Q02_General Questions->A - 4. The subject content is delivered according to the course outline and meets my expectations`, `Q02_General Questions->A - 5. The topics are clear and logically developed`, `Q02_General Questions->A - 6. I am developing my oral and writing skills`, `Q02_General Questions->A - 7. I am developing my reflective and critical reasoning skills`, `Q02_General Questions->A - 8. The assessment methods are assisting me to learn`, `Q02_General Questions->A - 9. I receive relevant feedback`, `Q02_General Questions->A - 10. I read the recommended readings and notes`, `Q02_General Questions->A - 11. I use the eLearning material posted`))) %>%
  
  # average_level_of_learning_achieved
  mutate(average_level_of_learning_achieved = mean(c(`Q03_Level of Learning Achieved->B - 1. Concept 1 of 4 - Ensemble Methods for Predictive Analytics`, `Q03_Level of Learning Achieved->B - 2. Concept 2 of 4 - Predictive Modelling Using R`))) %>%

  # average_quality_of_teaching_strategies  
  mutate(average_quality_of_teaching_strategies = mean(c(`Q04_Quality of Teaching Strategies->C - 1. Labs with comments that describe each step to be followed`, `Q04_Quality of Teaching Strategies->C - 2. Labs that require you to put in effort to make a submission related to the content of the lab`, `Q04_Quality of Teaching Strategies->C - 3. Labs that require you to use Git to work in a team`, `Q04_Quality of Teaching Strategies->C - 4. Labs that require you to work alone`, `Q04_Quality of Teaching Strategies->C - 5. The quality of the lectures given (quality measured by the breadth (the full span of knowledge of a subject) and depth (the extent to which specific topics are focused upon, amplified, and explored) of learning - NOT quality measured by how fun/comical/lively the lectures are)`, `Q04_Quality of Teaching Strategies->C - 6. The recordings of online classes`, `Q04_Quality of Teaching Strategies->C - 7. Online classes in general`, `Q04_Quality of Teaching Strategies->C - 8. Face-to-Face classes in general`))) %>%

  # If we had to sort the results
  arrange(`average_course_evaluation_rating`) %>%

  rename(
    `A. I am enjoying the subject` =
      `Q02_General Questions->A - 1. I am enjoying the subject`,
    `B. Classes start and end on time` =
      `Q02_General Questions->A - 2. Classes start and end on time`,
    `C. The learning environment is participative, involves learning by doing and is group-based` =
      `Q02_General Questions->A - 3. The learning environment is participative, involves learning by doing and is group-based`,
    `D. The subject content is delivered according to the course outline and meets my expectations` =
      `Q02_General Questions->A - 4. The subject content is delivered according to the course outline and meets my expectations`,
    `E. The topics are clear and logically developed` =
      `Q02_General Questions->A - 5. The topics are clear and logically developed`,
    `F. I am developing my oral and writing skills` =
      `Q02_General Questions->A - 6. I am developing my oral and writing skills`,
    `G. I am developing my reflective and critical reasoning skills` =
      `Q02_General Questions->A - 7. I am developing my reflective and critical reasoning skills`,
    `H. The assessment methods are assisting me to learn` =
      `Q02_General Questions->A - 8. The assessment methods are assisting me to learn`,
    `I. I receive relevant feedback` =
      `Q02_General Questions->A - 9. I receive relevant feedback`,
    `J. I read the recommended readings and notes` =
      `Q02_General Questions->A - 10. I read the recommended readings and notes`,
    `K. I use the eLearning material posted` =
      `Q02_General Questions->A - 11. I use the eLearning material posted`,
     `L. Average Quality of Teaching Strategies` =
      average_quality_of_teaching_strategies,
     `M. Average Level of Learning Achieved` =
      average_level_of_learning_achieved,
     `N. Average Course Evaluation Rating` =
      average_course_evaluation_rating
  ) %>%
  select(
    `Class Group`,
    `Gender`,
    `A. I am enjoying the subject`,
    `B. Classes start and end on time`,
    `C. The learning environment is participative, involves learning by doing and is group-based`,
    `D. The subject content is delivered according to the course outline and meets my expectations`,
    `E. The topics are clear and logically developed`,
    `F. I am developing my oral and writing skills`,
    `G. I am developing my reflective and critical reasoning skills`,
    `H. The assessment methods are assisting me to learn`,
    `I. I receive relevant feedback`,
    `J. I read the recommended readings and notes`,
    `K. I use the eLearning material posted`,
    `L. Average Quality of Teaching Strategies`,
    `M. Average Level of Learning Achieved`,
    `N. Average Course Evaluation Rating`,
    `Likes`,
    `Wishes`
  )

expand_contractions <- function(doc) {
  doc <- gsub("I'm", "I am", doc, ignore.case = TRUE)
  doc <- gsub("you're", "you are", doc, ignore.case = TRUE)
  doc <- gsub("he's", "he is", doc, ignore.case = TRUE)
  doc <- gsub("she's", "she is", doc, ignore.case = TRUE)
  doc <- gsub("it's", "it is", doc, ignore.case = TRUE)
  doc <- gsub("we're", "we are", doc, ignore.case = TRUE)
  doc <- gsub("they're", "they are", doc, ignore.case = TRUE)
  doc <- gsub("I'll", "I will", doc, ignore.case = TRUE)
  doc <- gsub("you'll", "you will", doc, ignore.case = TRUE)
  doc <- gsub("he'll", "he will", doc, ignore.case = TRUE)
  doc <- gsub("she'll", "she will", doc, ignore.case = TRUE)
  doc <- gsub("it'll", "it will", doc, ignore.case = TRUE)
  doc <- gsub("we'll", "we will", doc, ignore.case = TRUE)
  doc <- gsub("they'll", "they will", doc, ignore.case = TRUE)
  doc <- gsub("won't", "will not", doc, ignore.case = TRUE)
  doc <- gsub("can't", "cannot", doc, ignore.case = TRUE)
  doc <- gsub("n't", " not", doc, ignore.case = TRUE)
  return(doc)
}

# Expand contractions
evaluation_likes_and_wishes$Likes <- sapply(evaluation_likes_and_wishes$Likes, expand_contractions)

evaluation_likes_and_wishes$Wishes <- sapply(evaluation_likes_and_wishes$Wishes, expand_contractions)

# Remove special characters
remove_special_characters <- function(doc) {
  gsub("[^a-zA-Z ]", "", doc, ignore.case = TRUE)
}

evaluation_likes_and_wishes$Likes <- sapply(evaluation_likes_and_wishes$Likes, remove_special_characters)

evaluation_likes_and_wishes$Wishes <- sapply(evaluation_likes_and_wishes$Wishes, remove_special_characters)

# Tokenization, stopword removal, censorship, short word removal
undesirable_words <- c("wow", "lol", "none", "na")

evaluation_likes_filtered <- evaluation_likes_and_wishes %>%
  # We start by tokenization (un-nesting words). This is from the variable
  # "Like" into the variable "word".
  unnest_tokens(word, Likes, token = "ngrams", n = 1) %>%
  # Then we remove stopwords using an anti-join
  # Anti-join: do not join where the word is in the list of stopwords
  anti_join(stop_words, by = c("word")) %>%
  distinct() %>%
  # Censor or filter out unwanted words
  filter(!word %in% undesirable_words) %>%
  # Include only words that are more than 3 characters long (assuming that
  # these are the words that are meaningful)
  filter(nchar(word) > 3) %>%
  # We then rename the variable "word" for ease of use.
  rename(`Likes` = word) %>%
  # We focus only on the likes in this data frame
  select(-Wishes)

# The same is done to create a data frame for the "wishes" only
evaluation_wishes_filtered <- evaluation_likes_and_wishes %>% # nolint
  unnest_tokens(word, Wishes, token = "ngrams", n = 1) %>%
  anti_join(stop_words, by = c("word")) %>%
  distinct() %>%
  filter(!word %in% undesirable_words) %>%
  filter(nchar(word) > 3) %>%
  rename(`Wishes` = word) %>%
  select(-Likes)

# Correct Spelling
correct_spelling <- function(x) {
  sapply(1:length(x),
    function(y) {
      bad <- hunspell(x[y])[[1]]
      good <-
        unlist(lapply(hunspell_suggest(bad),
                      `[[`, 1))

      if (length(bad)) {
        for (i in 1:length(bad)){
          x[y] <<- gsub(bad[i], good[i], x[y])
        }
      }
    }
  )
  x
}

# Likes
corrected_spelling <-
  evaluation_likes_filtered$`Likes` %>%
  correct_spelling()

evaluation_likes_filtered$`Likes` <- corrected_spelling

# The repeated pre-processing includes:
# 1. Expanding Contractions
evaluation_likes_filtered$`Likes` <- sapply(evaluation_likes_filtered$`Likes`, expand_contractions)

# 2. Remove special Characters
evaluation_likes_filtered$`Likes` <- sapply(evaluation_likes_filtered$`Likes`, remove_special_characters)

# 3. Convert to Lower-Case for a standard form
evaluation_likes_filtered$`Likes` <- sapply(evaluation_likes_filtered$`Likes`, tolower)

# 4. Tokenization, stopword removal, short word removal, and censorship
evaluation_likes_filtered <- evaluation_likes_filtered %>% # nolint
  unnest_tokens(word, `Likes`, token = "ngrams", n = 1) %>%
  anti_join(stop_words, by = c("word")) %>%
  distinct() %>%
  filter(!word %in% undesirable_words) %>%
  filter(nchar(word) > 3) %>%
  rename(`Likes` = word)

# Wishes
corrected_spelling <-
  evaluation_wishes_filtered$`Wishes` %>%
  correct_spelling()

evaluation_wishes_filtered$`Wishes` <- corrected_spelling

### Repeat the pre-processing for the correctly spelt words ----
# This is done for the sake of the words which were split into more than one
# word after correcting the spelling mistake.

# The repeated pre-processing includes:
# 1. Expanding Contractions
evaluation_wishes_filtered$`Wishes` <- sapply(evaluation_wishes_filtered$`Wishes`, expand_contractions) # nolint
# 2. Remove special Characters
evaluation_wishes_filtered$`Wishes` <- sapply(evaluation_wishes_filtered$`Wishes`, remove_special_characters) # nolint
# 3. Convert to Lower-Case for a standard form
evaluation_wishes_filtered$`Wishes` <- sapply(evaluation_wishes_filtered$`Wishes`, tolower) # nolint

# 4. Tokenization, stopword removal, short word removal, and censorship
evaluation_wishes_filtered <- evaluation_wishes_filtered %>% # nolint
  unnest_tokens(word, `Wishes`, token = "ngrams", n = 1) %>%
  anti_join(stop_words, by = c("word")) %>%
  distinct() %>%
  filter(!word %in% undesirable_words) %>%
  filter(nchar(word) > 3) %>%
  rename(`Wishes` = word)

### We can now perform lemmatization on the correctly spelt words ----
# We need to first create a lemma lookup table. The lemmatize_strings()
# function will then use this lookup table to replace the words.

# Think of the lemma lookup table as a subset of an entire lemma dictionary.
# This makes it easier to search for a word in the smaller lookup table
# instead of searching for a word in the entire lemma dictionary.

# Lemma lookup tables specific to a project can be made by referring to
# a pre-existing lemma dictionary. The code below shows how the "Hunspell"
# lemma dictionary is used to create  the lemma lookup table (subset of
# the dictionary).

# Lemma dictionaries include:
#   1. Hunspell: https://hunspell.github.io/ or
#                https://cran.r-project.org/package=hunspell
#   2. koRpus: https://reaktanz.de/?c=hacking&s=koRpus or
#              https://cran.r-project.org/package=koRpus
#   3. Michal Měchura (2016): https://www.lexiconista.com/
#   etc.

lemma_dictionary_for_likes <-
  make_lemma_dictionary(evaluation_likes_filtered$`Likes`,
                        engine = "hunspell")

evaluation_likes_filtered$`Likes` <-
  evaluation_likes_filtered$`Likes` %>%
  lemmatize_strings(dictionary = lemma_dictionary_for_likes)

lemma_dictionary_for_wishes <-
  make_lemma_dictionary(evaluation_wishes_filtered$`Wishes`,
                        engine = "hunspell")

evaluation_wishes_filtered$`Wishes` <-
  evaluation_wishes_filtered$`Wishes` %>%
  lemmatize_strings(dictionary = lemma_dictionary_for_wishes)
```

```{r SignificantWords_Likes, eval=FALSE, include=FALSE}
## Evaluation Likes ----
evaluation_likes_filtered_cloud <- evaluation_likes_filtered %>% # nolint
  count(`Likes`, sort = TRUE)

wordcloud2(evaluation_likes_filtered_cloud, size = .5)

```

```{r SignificantWords_Wishes, eval=FALSE, include=FALSE}
## Evaluation Wishes ----
evaluation_wishes_filtered_cloud <- evaluation_wishes_filtered %>%
  count(`Wishes`, sort = TRUE)

wordcloud2(evaluation_wishes_filtered_cloud, size = .5)
```

```{r removed_TFIDF_section_comment1, eval=FALSE, include=FALSE}
# Term Frequency - Inverse Document Frequency (TF-IDF) Score
# 
# The plot below presents the quantitative measure of "significance" using the Term Frequency - Inverse Document Frequency (TF-IDF) score:
# 
# TF-IDF Score (likes) per gender:
```

```{r TF-IDFLikesPerGender, eval=FALSE, include=FALSE}
popular_tfidf_words_gender_likes <- evaluation_likes_filtered %>% # nolint
  unnest_tokens(word, `Likes`) %>%
  distinct() %>%
  filter(!word %in% undesirable_words) %>%
  filter(nchar(word) > 3) %>%
  rename(`Likes` = word) %>%
  select(`Class Group`, `Gender`,
         `N. Average Course Evaluation Rating`, `Likes`) %>%
  count(`Gender`, `Likes`, sort = TRUE) %>%
  ungroup() %>%
  bind_tf_idf(`Likes`, `Gender`, n)

top_popular_tfidf_words <- popular_tfidf_words_gender_likes %>%
  arrange(desc(tf_idf)) %>%
  mutate(`Likes` =
           factor(`Likes`,
                  levels = rev(unique(`Likes`)))) %>%
  group_by(`Gender`) %>%
  slice(seq_len(10)) %>%
  ungroup() %>%
  arrange(`Gender`, tf_idf) %>%
  mutate(row = row_number())

top_popular_tfidf_words %>%
  ggplot(aes(x = row, tf_idf, fill = `Gender`)) +
  geom_col(fill = blue_grey_colours_1) +
  blue_grey_theme() +
  labs(x = "Word in Course Evaluation", y = "TF-IDF Score") +
  ggtitle("Important Words using TF-IDF by Chart Level") +
  ggtitle("Most Important Words by TF-IDF Score in Course Evaluation Likes per 
      Gender") +
  facet_wrap(~`Gender`, scales = "free") +
  scale_x_continuous(
                     breaks = top_popular_tfidf_words$row,
                     labels = top_popular_tfidf_words$`Likes`) +
  coord_flip()
```

```{r removed_TFIDF_section_comment2, eval=FALSE, include=FALSE}
# \newpage
# 
# TF-IDF Score (likes) per specific class group:
```

```{r TF-IDFLikesPerGroup, eval=FALSE, include=FALSE}
### TF-IDF Score per Group ----
popular_tfidf_words_likes <- evaluation_likes_filtered %>% # nolint
  unnest_tokens(word, `Likes`) %>%
  distinct() %>%
  filter(!word %in% undesirable_words) %>%
  filter(nchar(word) > 3) %>%
  rename(`Likes` = word) %>%
  select(`Class Group`, `Gender`,
         `N. Average Course Evaluation Rating`, `Likes`) %>%
  count(`Class Group`, `Likes`, sort = TRUE) %>%
  ungroup() %>%
  bind_tf_idf(`Likes`, `Class Group`, n)

top_popular_tfidf_words <- popular_tfidf_words_likes %>%
  arrange(desc(tf_idf)) %>%
  mutate(`Likes` =
           factor(`Likes`,
                  levels = rev(unique(`Likes`)))) %>%
  group_by(`Class Group`) %>%
  slice(seq_len(10)) %>%
  ungroup() %>%
  arrange(`Class Group`, tf_idf) %>%
  mutate(row = row_number())

top_popular_tfidf_words %>%
  ggplot(aes(x = row, tf_idf, fill = `Class Group`)) +
  geom_col(fill = blue_grey_colours_1) +
  blue_grey_theme() +
  labs(x = "Word in Course Evaluation", y = "TF-IDF Score") +
  ggtitle("Important Words using TF-IDF by Chart Level") +
  ggtitle("Most Important Words by TF-IDF Score in Course Evaluation Likes per 
      Specific Class Group") +
  facet_wrap(~`Class Group`, scales = "free") +
  scale_x_continuous(
                     breaks = top_popular_tfidf_words$row,
                     labels = top_popular_tfidf_words$`Likes`) +
  coord_flip()
```

```{r removed_TFIDF_section_comment3, eval=FALSE, include=FALSE}
# \newpage
# 
# TF-IDF Score (wishes) per gender:
```

```{r TF-IDFWishesPerGender, eval=FALSE, include=FALSE}
## Evaluation Wishes ----
### TF-IDF Score per Gender ----
popular_tfidf_words_gender_wishes <- evaluation_wishes_filtered %>% # nolint
  unnest_tokens(word, `Wishes`) %>%
  distinct() %>%
  filter(!word %in% undesirable_words) %>%
  filter(nchar(word) > 3) %>%
  rename(`Wishes` = word) %>%
  select(`Class Group`, `Gender`,
         `N. Average Course Evaluation Rating`, `Wishes`) %>%
  count(`Gender`, `Wishes`, sort = TRUE) %>%
  ungroup() %>%
  bind_tf_idf(`Wishes`, `Gender`, n)

top_popular_tfidf_words <- popular_tfidf_words_gender_wishes %>%
  arrange(desc(tf_idf)) %>%
  mutate(`Wishes` =
           factor(`Wishes`,
                  levels = rev(unique(`Wishes`)))) %>%
  group_by(`Gender`) %>%
  slice(seq_len(10)) %>%
  ungroup() %>%
  arrange(`Gender`, tf_idf) %>%
  mutate(row = row_number())

top_popular_tfidf_words %>%
  ggplot(aes(x = row, tf_idf, fill = `Gender`)) +
  geom_col(fill = blue_grey_colours_1) +
  blue_grey_theme() +
  labs(x = "Word in Course Evaluation", y = "TF-IDF Score") +
  ggtitle("Important Words using TF-IDF by Chart Level") +
  ggtitle("Most Important Words by TF-IDF Score in Course Evaluation Wishes per 
      Gender") +
  facet_wrap(~`Gender`, scales = "free") +
  scale_x_continuous(
                     breaks = top_popular_tfidf_words$row,
                     labels = top_popular_tfidf_words$`Wishes`) +
  coord_flip()
```

```{r removed_TFIDF_section_comment4, eval=FALSE, include=FALSE}
# \newpage
# 
# TF-IDF score (wishes) per specific class group:
```

```{r TF-IDFWishesPerGroup, eval=FALSE, include=FALSE}
### TF-IDF Score per Group ----
popular_tfidf_words_likes <- evaluation_wishes_filtered %>% # nolint
  unnest_tokens(word, `Wishes`) %>%
  distinct() %>%
  filter(!word %in% undesirable_words) %>%
  filter(nchar(word) > 3) %>%
  rename(`Wishes` = word) %>%
  select(`Class Group`, `Gender`,
         `N. Average Course Evaluation Rating`, `Wishes`) %>%
  count(`Class Group`, `Wishes`, sort = TRUE) %>%
  ungroup() %>%
  bind_tf_idf(`Wishes`, `Class Group`, n)

top_popular_tfidf_words <- popular_tfidf_words_likes %>%
  arrange(desc(tf_idf)) %>%
  mutate(`Wishes` =
           factor(`Wishes`,
                  levels = rev(unique(`Wishes`)))) %>%
  group_by(`Class Group`) %>%
  slice(seq_len(10)) %>%
  ungroup() %>%
  arrange(`Class Group`, tf_idf) %>%
  mutate(row = row_number())

top_popular_tfidf_words %>%
  ggplot(aes(x = row, tf_idf, fill = `Class Group`)) +
  geom_col(fill = blue_grey_colours_1) +
  blue_grey_theme() +
  labs(x = "Word in Course Evaluation", y = "TF-IDF Score") +
  ggtitle("Important Words using TF-IDF by Chart Level") +
  ggtitle("Most Important Words by TF-IDF Score in Course Evaluation Wishes per 
      Specific Class Group") +
  facet_wrap(~`Class Group`, scales = "free") +
  scale_x_continuous(
                     breaks = top_popular_tfidf_words$row,
                     labels = top_popular_tfidf_words$`Wishes`) +
  coord_flip()
```

## Sentiment Analysis (Lexicon-Based)

```{r SentimentAnalysisWithNRC, include=FALSE}
nrc <- get_sentiments("nrc")

# Inner Join the Likes/Wishes with the Corresponding Sentiment(s) ----
evaluation_likes_filtered_nrc <- evaluation_likes_filtered %>%
  inner_join(get_sentiments("nrc"),
             by = join_by(`Likes` == word),
             relationship = "many-to-many")

evaluation_wishes_filtered_nrc <- evaluation_wishes_filtered %>%
  inner_join(get_sentiments("nrc"),
             by = join_by(`Wishes` == word),
             relationship = "many-to-many")

```

The overall sentiment for the likes is:

```{r OverallSentimentForLikes, echo=FALSE, fig.height=5, message=FALSE, warning=FALSE}
# STEP 6. Overall Sentiment ----
## Evaluation Likes ----
nrc_likes_plot <- evaluation_likes_filtered_nrc %>%
  group_by(sentiment) %>%
  # You can filter by the class group if you wish
  # filter(`Class Group` == "A") %>%
  summarise(word_count = n()) %>%
  ungroup() %>%
  mutate(sentiment = reorder(sentiment, word_count)) %>%
  # `fill = -word_count` is used to make the larger bars darker
  ggplot(aes(sentiment, word_count, fill = -word_count)) +
  geom_col() +
  guides(fill = FALSE) + # Turn off the legend
  blue_grey_theme() +
  labs(x = "Sentiment", y = "Word Count") +
  # scale_y_continuous(limits = c(0, 15000)) + #Hard code the axis limit
  ggtitle("Lexicon-Based Sentiment Analysis of Course Evaluation Likes") +
  coord_flip()
plot(nrc_likes_plot)
```

\newpage

The overall sentiment for the wishes is:

```{r OverallSentimentForWishes, echo=FALSE, fig.height=8, message=FALSE, warning=FALSE}
## Evaluation Wishes ----
nrc_wishes_plot <- evaluation_wishes_filtered_nrc %>%
  group_by(sentiment) %>%
  # You can filter by the class group if you wish
  # filter(`Class Group` == "A") %>%
  summarise(word_count = n()) %>%
  ungroup() %>%
  mutate(sentiment = reorder(sentiment, word_count)) %>%
  # fill = -word_count is used to make the larger bars darker
  ggplot(aes(sentiment, word_count, fill = -word_count)) +
  geom_col() +
  guides(fill = FALSE) + # Turn off the legend
  blue_grey_theme() +
  labs(x = "Sentiment", y = "Word Count") +
  # scale_y_continuous(limits = c(0, 15000)) + #Hard code the axis limit
  ggtitle("Lexicon-Based Sentiment Analysis of Course Evaluation Wishes") +
  coord_flip()
plot(nrc_wishes_plot)
```

\newpage

Chord Diagram of Likes per Class Group:

```{r ChordDiagramLikesPerGroup, echo=FALSE, message=FALSE, warning=FALSE}
nrc_likes_chord <-  evaluation_likes_filtered_nrc %>%
  count(sentiment, `Class Group`) %>%
  group_by(`Class Group`, sentiment) %>%
  summarise(sentiment_sum = sum(n)) %>%
  filter(sentiment_sum > 5) %>%
  mutate(sentiment = reorder(sentiment, sentiment_sum)) %>%
  ungroup()

circos.clear()
# Set the gap size
circos.par(gap.after = c(rep(5, length(unique(nrc_likes_chord[[1]])) - 1), 15,
                         rep(5, length(unique(nrc_likes_chord[[2]])) - 1), 15))


chordDiagram(nrc_likes_chord, transparency = .2)
title("Lexicon-Based Sentiment Analysis of Course Evaluation Likes per Class Group")
```

\newpage

Chord Diagram of Likes per Class Gender:

```{r ChordDiagramLikesPerGender, echo=FALSE, message=FALSE, warning=FALSE}
nrc_likes_chord <-  evaluation_likes_filtered_nrc %>%
  count(sentiment, `Gender`) %>%
  group_by(`Gender`, sentiment) %>%
  summarise(sentiment_sum = sum(n)) %>%
  filter(sentiment_sum > 5) %>%
  mutate(sentiment = reorder(sentiment, sentiment_sum)) %>%
  ungroup()

circos.clear()
# Set the gap size
circos.par(gap.after = c(rep(5, length(unique(nrc_likes_chord[[1]])) - 1), 15,
                         rep(5, length(unique(nrc_likes_chord[[2]])) - 1), 15))


chordDiagram(nrc_likes_chord, transparency = .2)
title("Lexicon-Based Sentiment Analysis of Course Evaluation Likes per Gender")
```

\newpage

Chord Diagram of Wishes per Class Group:

```{r ChordDiagramPerGroup_Wishes, echo=FALSE, message=FALSE, warning=FALSE}
nrc_wishes_chord <-  evaluation_wishes_filtered_nrc %>%
  count(sentiment, `Class Group`) %>%
  group_by(`Class Group`, sentiment) %>%
  summarise(sentiment_sum = sum(n)) %>%
  filter(sentiment_sum > 3) %>%
  mutate(sentiment = reorder(sentiment, sentiment_sum)) %>%
  ungroup()

circos.clear()
# Set the gap size
circos.par(gap.after = c(rep(5, length(unique(nrc_wishes_chord[[1]])) - 1), 15,
                         rep(5, length(unique(nrc_wishes_chord[[2]])) - 1), 15))

chordDiagram(nrc_wishes_chord, transparency = .2)
title("Lexicon-Based Sentiment Analysis of Course Evaluation Wishes per Class Group")

```

\newpage

Chord Diagram of Wishes per Gender:

```{r ChordDiagramPerGender_Wishes, echo=FALSE, message=FALSE, warning=FALSE}
nrc_wishes_chord <-  evaluation_wishes_filtered_nrc %>%
  count(sentiment, `Gender`) %>%
  group_by(`Gender`, sentiment) %>%
  summarise(sentiment_sum = sum(n)) %>%
  filter(sentiment_sum > 3) %>%
  mutate(sentiment = reorder(sentiment, sentiment_sum)) %>%
  ungroup()

circos.clear()
# Set the gap size
circos.par(gap.after = c(rep(5, length(unique(nrc_wishes_chord[[1]])) - 1), 15,
                         rep(5, length(unique(nrc_wishes_chord[[2]])) - 1), 15))

chordDiagram(nrc_wishes_chord, transparency = .2)
title("Lexicon-Based Sentiment Analysis of Course Evaluation Wishes per Group")
```

\newpage

## Topic Modelling (Latent Dirichlet Allocation (LDA) based)

The goal of topic modelling is to identify significant thematically related terms (topics) in the students' course evaluation textual feedback. In this case, a topic is a mixture of words and a student's textual feedback is a combination of one or more topics (mixed-membership model).

The algorithm used is Latent Dirichlet Allocation (LDA).

```{r Create_a_DTM, message=TRUE, warning=TRUE, include=FALSE}
# LDA requires the data to be presented in a Document-Term Matrix (DTM)
# format. The conversion into a DTM is done below: 
evaluation_likes_filtered_dtm <-    evaluation_likes_filtered %>%   count(`Class Group`, Likes, sort = TRUE) %>%   ungroup() %>%   cast_dtm(`Class Group`, Likes, n)

# inspect(evaluation_likes_filtered_dtm)
evaluation_wishes_filtered_dtm <-    evaluation_wishes_filtered %>%   count(`Class Group`, Wishes, sort = TRUE) %>%   ungroup() %>%   cast_dtm(`Class Group`, Wishes, n) # inspect(evaluation_likes_filtered_dtm)
```

```{r train_LDA_model_for_topic_modelling, message=TRUE, warning=TRUE, include=FALSE}
likes_topic_model <- LDA(evaluation_likes_filtered_dtm,
                         k = 6,
                         control = list(seed = 7))
wishes_topic_model <- LDA(evaluation_wishes_filtered_dtm,
                          k = 6,
                          control = list(seed = 7))
```

```{r visualizations_for_likes_topic_modelling, echo=FALSE}
likes_topics <- tidy(likes_topic_model, matrix = "beta")
likes_top_terms <-
  likes_topics %>%
  group_by (topic) %>%
  top_n(10, beta) %>%
  ungroup() %>%
  arrange(topic, -beta)

likes_top_terms %>%
  mutate(term = reorder(term, beta)) %>%
  ggplot(aes(term, beta, fill = factor(topic))) +   geom_col(show.legend = FALSE) +   facet_wrap(~topic, scales = "free") +   theme_minimal() +   theme(plot.title =            element_text(hjust = 0.5, size = 18)) +   labs(     title = "Topic Model of Course Evaluation Likes",     caption = "Top Terms by Topic (betas)"     ) +   ylab("") +   xlab("") +   coord_flip()
```

\newpage

```{r visualizations_for_wishes_topic_modelling, echo=FALSE}
wishes_topics <- tidy(wishes_topic_model, matrix = "beta")
wishes_top_terms <-
  wishes_topics %>%
  group_by (topic) %>%
  top_n(10, beta) %>%
  ungroup() %>%
  arrange(topic, -beta)

wishes_top_terms %>%
  mutate(term = reorder(term, beta)) %>%
  ggplot(aes(term, beta, fill = factor(topic))) +
  geom_col(show.legend = FALSE) +   facet_wrap(~topic, scales = "free") +   theme_minimal() + theme(plot.title = element_text(hjust = 0.5, size = 18)) +   labs(     title = "Topic Model of Course Evaluation Wishes",     caption = "Top Terms by Topic (betas)"     ) +   ylab("") +   xlab("") +   coord_flip()
```

\newpage

# Appendix A

## Raw Qualitative Data

### Likes

The raw data of the likes is as follows:

```{r RawLikesData, echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(course_evaluation_dataset$`Q05_Likes->D - 1. Write two things you like about the teaching and learning in this unit so far.`, caption = "Write two things you like about the teaching and learning in this unit so far", digits = 4, col.names = "Comment (Likes)", align = "l", escape = TRUE, longtable = TRUE, booktabs = TRUE, linesep = "\\hline") %>%
  column_spec(1, width = "35em", extra_css = "border-bottom: 1px solid;") %>% 
  kable_styling(latex_options="scale_down")

# course_evaluation_dataset$`Q05_Likes->D - 1. Write two things you like about the teaching and learning in this unit so far.` %>%
  # my_kable_styling("Write two things you like about the teaching and learning in this unit so far")
```

\newpage

### Wishes

The raw data of the wishes is as follows:

```{r RawWishesData, echo=FALSE, message=FALSE, warning=FALSE}
knitr::kable(course_evaluation_dataset$`Q05_Wishes->D - 2. Write at least one recommendation to improve the teaching and learning in this unit (for the remaining weeks in the semester)`, caption = "Write at least one recommendation to improve the teaching and learning in this unit (for the remaining weeks in the semester)", digits = 4, col.names = "Comment (Wishes)", align = "l", escape = TRUE, longtable = TRUE, booktabs = TRUE, linesep = "\\hline") %>%
  column_spec(1, width = "35em", extra_css = "border-bottom: 1px solid;") %>% 
  kable_styling(latex_options="scale_down")

# course_evaluation_dataset$`Q05_Wishes->D - 2. Write at least one recommendation to improve the teaching and learning in this unit (for the remaining weeks in the semester)` %>%
  # my_kable_styling("Write at least one recommendation to improve the teaching and learning in this unit (for the remaining weeks in the semester)")
```
